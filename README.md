# Memprintf

This library provide several very simple bitwise operation APIs, 
and a function named memprintf, which looks like printf(in some way).


## Story

I was trying to do some regular programming for our CCD control project the other day,
suddenly I realize that most of my code could be concluded into one certain partern:
to extract a certain part of mem, regard it as int/float/bool,
and do some very basic calculation,
and then return this value.

These work have basically, no techique at all,
and I can't find any plessure doing this.
So I decided to find some tools to help me out of these manual labor,
but I find that might because these is just too simple that literally nobody ever
have share such a library, thus I start this repo.

I'll add some new features after the CCD control project finished.

## Basic Usage
```C++
void memprintf(char *dest, size_t dest_len, const char *fmt, uint8_t *mem, size_t mem_len);
```

```dest```
is a ptr toward where the result will be storaged.
 
```dest_len```
is the lenth of mem which dest point at.

```fmt```
is the format string. fmt use '%' as escape char,
the program will regard anything that follows the pattern 
of %[number][f/d/n] as a sensitive part and 
substitue it with a string.

%[number][f/d/n]

This string is generated by these procedure:

1. Get first [number] **bits** from mem
2. Convert these bits as if they were:
  2.a float, if the next character is [f]
  2.b integer, if the next character is [d]
  2.c nothing, if the next character is [n]

(I know I have difficuty describing these rules,
maybe provide some examples later)

If everything is alright the output string
will be copied to ```dest```,
otherwise will leave everything untouched.

```C++
int GET_NTH_BIT_OF_MEM(void *mem, size_t mem_len, int idx);
int SET_NTH_BIT_OF_MEM(void *mem, size_t mem_len, int idx, int value);
```
These two API provide the ability of access any bit in a mem,
for GET API, if everything work out the return value can be 0 or 1.
When a negative value is returned, it means that 
this the mem is not long enough.
For SET API, the only correct return value is 0.




